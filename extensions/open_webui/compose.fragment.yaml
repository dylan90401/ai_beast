# Open WebUI - ChatGPT-style interface for Ollama
services:
  open-webui:
    image: ghcr.io/open-webui/open-webui:main
    container_name: ai_beast_open_webui
    profiles: ["webui", "open_webui", "full", "prodish"]
    depends_on:
      qdrant:
        condition: service_healthy
        required: false
    ports:
      - "${AI_BEAST_BIND_ADDR:-127.0.0.1}:${PORT_WEBUI:-3000}:8080"
    environment:
      OLLAMA_BASE_URL: "http://host.docker.internal:${PORT_OLLAMA:-11434}"
      QDRANT_URL: "http://qdrant:6333"
      WEBUI_AUTH: "false"
      ENABLE_RAG_WEB_SEARCH: "true"
      RAG_EMBEDDING_MODEL: "nomic-embed-text"
    volumes:
      - open_webui_data:/app/backend/data
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3

volumes:
  open_webui_data:
